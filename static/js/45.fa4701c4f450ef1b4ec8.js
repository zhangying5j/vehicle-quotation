webpackJsonp([45],{EUY8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("Dd8w"),i=n.n(a),r=n("NYxO"),o={name:"ReportCustom",components:{BaseTable:function(){return n.e(87).then(n.bind(null,"ss0d"))}},data:function(){return{activeName:"select",params:{scene:"",insMonth:"",secondOrg:"",thirdOrg:"",channel:"",carFlag:""},thirdOrgList:[],rules:{},columnShowList:[],indexShow:!1,detailShow:!1,currentDimCode:[],currentIndexCode:[],dimColumn:[],indexColumn:[]}},created:function(){},computed:i()({currentDimList:function(){var t=this;return this.currentDimCode.map(function(e){return t.formData.dimList.find(function(t){return t.code===e})})},currentIndexList:function(){var t=this;return this.currentIndexCode.map(function(e){return t.formData.indexList.find(function(t){return t.code===e})})},columns:function(){var t=[];return(this.dimColumn.length>0||this.indexColumn>0)&&(t.push({prop:"insMonth",width:120,label:"承保月份"}),t.push({prop:"secondOrg",width:120,label:"二级机构"}),t.push({prop:"thirdOrg",width:120,label:"三级机构"})),t.concat(this.dimColumn).concat(this.indexColumn)}},Object(r.c)({formData:function(t){return t.chart.formData},tableData:function(t){return t.chart.tableData}})),watch:{currentDimList:function(t){var e=this;this.dimColumn=[],t.forEach(function(t){e.dimColumn.push({prop:t.code,label:t.name,width:t.width})})},currentIndexList:function(t){var e=this;this.indexColumn=[],t.forEach(function(t){e.indexColumn.push({prop:t.code,label:t.name,width:t.width})})}},methods:{dimChange:function(t){this.currentDimCode=t},addIndex:function(t){this.currentIndexCode.includes(t)||this.currentIndexCode.push(t)},removeIndex:function(t){this.currentIndexCode.splice(this.currentIndexCode.indexOf(t),1)},query:function(){this.$store.dispatch("getTabData")},release:function(){var t=this;this.$confirm("确定发布该自定义报表吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message({type:"success",message:"发布成功!"})}).catch(function(){})},getThridOrg:function(t){var e=this.formData.orgList.find(function(e){return e.code===t});this.thirdOrgList=e.children}}},s={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-collapse",{attrs:{accordion:""},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-collapse-item",{attrs:{title:t.params.scene,name:"select"}},[n("div",{staticClass:"sector-list"},[n("div",{staticClass:"title"},[t._v("选择维度")]),t._v(" "),n("div",{staticClass:"biz-sector"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:24}},[n("el-form",{attrs:{"label-width":"120px",inline:!0}},[n("el-form-item",[n("el-checkbox-group",{on:{change:t.dimChange},model:{value:t.columnShowList,callback:function(e){t.columnShowList=e},expression:"columnShowList"}},t._l(t.formData.dimList,function(e){return n("el-checkbox",{key:e.code,attrs:{label:e.code}},[t._v(t._s(e.name))])}))],1)],1)],1)],1)],1)]),t._v(" "),n("div",{staticClass:"sector-list"},[n("div",{staticClass:"title"},[t._v("选择指标")]),t._v(" "),n("div",{staticClass:"biz-sector"},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:24}},[n("div",{staticClass:"grid-content bg-purple-light"},[n("div",{staticClass:"tag"},[t._l(t.currentIndexList,function(e){return n("el-tag",{key:e.code,attrs:{closable:"",type:"primary"},on:{close:function(n){t.removeIndex(e.code)}}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])}),t._v(" "),n("el-button",{attrs:{size:"small",plain:"",icon:"el-icon-plus"},on:{click:function(e){t.indexShow=!0}}},[t._v("新增指标")])],2)])])],1)],1)])])],1),t._v(" "),n("div",{staticClass:"form"},[n("el-form",{ref:"chartForm",attrs:{"label-width":"180px",model:t.params,rules:t.rules,inline:!0}},[n("el-form-item",{attrs:{label:"承保月份",prop:"insMonth"}},[n("el-select",{attrs:{placeholder:"请选择承保月份"},model:{value:t.params.insMonth,callback:function(e){t.$set(t.params,"insMonth",e)},expression:"params.insMonth"}},t._l(t.formData.insMonthList,function(t){return n("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})}))],1),t._v(" "),n("el-form-item",{attrs:{label:"二级机构",prop:"secondOrg"}},[n("el-select",{attrs:{placeholder:"请选择二级机构"},on:{change:t.getThridOrg},model:{value:t.params.secondOrg,callback:function(e){t.$set(t.params,"secondOrg",e)},expression:"params.secondOrg"}},t._l(t.formData.orgList,function(t){return n("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})}))],1),t._v(" "),n("el-form-item",{attrs:{label:"三级机构",prop:"thirdOrg"}},[n("el-select",{attrs:{placeholder:"请选择三级机构"},model:{value:t.params.thirdOrg,callback:function(e){t.$set(t.params,"thirdOrg",e)},expression:"params.thirdOrg"}},t._l(t.thirdOrgList,function(t){return n("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})}))],1),t._v(" "),t._l(t.currentDimList,function(e){return n("el-form-item",{key:e.code,attrs:{label:e.name,prop:e.name}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.params[e.code],callback:function(n){t.$set(t.params,e.code,n)},expression:"params[dim.code]"}},t._l(e.detail,function(t){return n("el-option",{key:t.code,attrs:{value:t.code,label:t.name}})}))],1)})],2)],1),t._v(" "),n("div",{staticClass:"option"},[n("el-button",{attrs:{plain:"",size:"small",type:"primary"},on:{click:t.query}},[t._v("查询")]),t._v(" "),n("el-button",{attrs:{plain:"",size:"small",type:"primary"},on:{click:t.release}},[t._v("发布")])],1),t._v(" "),n("div",{staticClass:"data"},[n("div",{staticClass:"table"},[n("base-table",{attrs:{columns:t.columns,data:t.tableData}})],1)]),t._v(" "),n("el-dialog",{attrs:{title:"选择指标",visible:t.indexShow,width:"30%"},on:{"update:visible":function(e){t.indexShow=e}}},t._l(t.formData.indexList,function(e){return n("el-tag",{key:e.code,attrs:{type:t.currentIndexCode.includes(e.code)?"primary":"info"},nativeOn:{click:function(n){t.addIndex(e.code)}}},[t._v("\n      "+t._s(e.name)+"\n    ")])}))],1)},staticRenderFns:[]};var l=n("VU/8")(o,s,!1,function(t){n("gGYY")},"data-v-4717c4aa",null);e.default=l.exports},gGYY:function(t,e){}});